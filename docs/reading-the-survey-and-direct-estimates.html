<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Reading the survey and direct estimates | Area-models-for-estimating-poverty-and-labor-market-indicators</title>
  <meta name="description" content="Area models for estimating poverty and labor market indicators" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Reading the survey and direct estimates | Area-models-for-estimating-poverty-and-labor-market-indicators" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Area models for estimating poverty and labor market indicators" />
  <meta name="github-repo" content="psirusteam/HHS-Handbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Reading the survey and direct estimates | Area-models-for-estimating-poverty-and-labor-market-indicators" />
  
  <meta name="twitter:description" content="Area models for estimating poverty and labor market indicators" />
  



<meta name="date" content="2023-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="loading-libraries.html"/>
<link rel="next" href="domain-selection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Area models for estimating poverty and labor market indicators</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Workshop material</a>
<ul>
<li class="chapter" data-level="" data-path="workshop-material-1.html"><a href="workshop-material-1.html"><i class="fa fa-check"></i>Workshop material</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="session-1--census-and-satellite-information.html"><a href="session-1--census-and-satellite-information.html"><i class="fa fa-check"></i><b>1</b> Session 1- Census and satellite information</a>
<ul>
<li class="chapter" data-level="1.1" data-path="use-of-satellite-imagery-and-sae.html"><a href="use-of-satellite-imagery-and-sae.html"><i class="fa fa-check"></i><b>1.1</b> Use of Satellite Imagery and SAE</a></li>
<li class="chapter" data-level="1.2" data-path="satellite-image-data-sources.html"><a href="satellite-image-data-sources.html"><i class="fa fa-check"></i><b>1.2</b> Satellite Image Data Sources</a></li>
<li class="chapter" data-level="1.3" data-path="google-earth-engine.html"><a href="google-earth-engine.html"><i class="fa fa-check"></i><b>1.3</b> Google Earth Engine</a></li>
<li class="chapter" data-level="1.4" data-path="installing-rgee.html"><a href="installing-rgee.html"><i class="fa fa-check"></i><b>1.4</b> Installing rgee</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="installing-rgee.html"><a href="installing-rgee.html#downloading-satellite-information"><i class="fa fa-check"></i><b>1.4.1</b> Downloading Satellite Information</a></li>
<li class="chapter" data-level="1.4.2" data-path="installing-rgee.html"><a href="installing-rgee.html#night-lights"><i class="fa fa-check"></i><b>1.4.2</b> Night Lights</a></li>
<li class="chapter" data-level="1.4.3" data-path="installing-rgee.html"><a href="installing-rgee.html#crop-cover"><i class="fa fa-check"></i><b>1.4.3</b> Crop Cover</a></li>
<li class="chapter" data-level="1.4.4" data-path="installing-rgee.html"><a href="installing-rgee.html#urban-cover"><i class="fa fa-check"></i><b>1.4.4</b> Urban Cover</a></li>
<li class="chapter" data-level="1.4.5" data-path="installing-rgee.html"><a href="installing-rgee.html#human-modification"><i class="fa fa-check"></i><b>1.4.5</b> Human Modification</a></li>
<li class="chapter" data-level="1.4.6" data-path="installing-rgee.html"><a href="installing-rgee.html#average-travel-time-to-hospital"><i class="fa fa-check"></i><b>1.4.6</b> Average Travel Time to Hospital</a></li>
<li class="chapter" data-level="1.4.7" data-path="installing-rgee.html"><a href="installing-rgee.html#average-travel-time-to-hospital-by-non-motorized-vehicle"><i class="fa fa-check"></i><b>1.4.7</b> Average Travel Time to Hospital by Non-Motorized Vehicle</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="population-and-housing-censuses.html"><a href="population-and-housing-censuses.html"><i class="fa fa-check"></i><b>1.5</b> Population and Housing Censuses</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="population-and-housing-censuses.html"><a href="population-and-housing-censuses.html#mapas-de-las-variables-con-información-censal."><i class="fa fa-check"></i><b>1.5.1</b> Mapas de las variables con información censal.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="session-2--generalized-variance-function.html"><a href="session-2--generalized-variance-function.html"><i class="fa fa-check"></i><b>2</b> Session 2- Generalized Variance Function</a>
<ul>
<li class="chapter" data-level="2.1" data-path="graphical-analysis.html"><a href="graphical-analysis.html"><i class="fa fa-check"></i><b>2.1</b> Graphical Analysis</a></li>
<li class="chapter" data-level="2.2" data-path="variance-model.html"><a href="variance-model.html"><i class="fa fa-check"></i><b>2.2</b> Variance Model</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session-3--fay-herriot-model---poverty-estimation.html"><a href="session-3--fay-herriot-model---poverty-estimation.html"><i class="fa fa-check"></i><b>3</b> Session 3- Fay Herriot Model - Poverty Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="session-3--fay-herriot-model---poverty-estimation.html"><a href="session-3--fay-herriot-model---poverty-estimation.html#area-model-for-poverty-estimation"><i class="fa fa-check"></i>Area Model for Poverty Estimation</a></li>
<li class="chapter" data-level="" data-path="session-3--fay-herriot-model---poverty-estimation.html"><a href="session-3--fay-herriot-model---poverty-estimation.html#optimal-predictor-of-p_d"><i class="fa fa-check"></i>Optimal Predictor of <span class="math inline">\(P_d\)</span></a></li>
<li class="chapter" data-level="3.1" data-path="estimation-procedure.html"><a href="estimation-procedure.html"><i class="fa fa-check"></i><b>3.1</b> Estimation Procedure</a></li>
<li class="chapter" data-level="3.2" data-path="preparing-the-supplies-for-stan.html"><a href="preparing-the-supplies-for-stan.html"><i class="fa fa-check"></i><b>3.2</b> Preparing the supplies for <code>STAN</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="preparing-the-supplies-for-stan.html"><a href="preparing-the-supplies-for-stan.html#results-of-the-model-for-observed-domains."><i class="fa fa-check"></i><b>3.2.1</b> Results of the model for observed domains.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="area-models---arcsin-transformation..html"><a href="area-models---arcsin-transformation..html"><i class="fa fa-check"></i><b>3.3</b> Area models - ArcSin transformation.</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="area-models---arcsin-transformation..html"><a href="area-models---arcsin-transformation..html#estimation-procedure-1"><i class="fa fa-check"></i><b>3.3.1</b> Estimation procedure</a></li>
<li class="chapter" data-level="3.3.2" data-path="area-models---arcsin-transformation..html"><a href="area-models---arcsin-transformation..html#preparing-inputs-for-stan"><i class="fa fa-check"></i><b>3.3.2</b> Preparing Inputs for <code>STAN</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="benchmark-process.html"><a href="benchmark-process.html"><i class="fa fa-check"></i><b>3.4</b> Benchmark Process</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="benchmark-process.html"><a href="benchmark-process.html#results-validation"><i class="fa fa-check"></i><b>3.4.1</b> Results Validation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="poverty-map.html"><a href="poverty-map.html"><i class="fa fa-check"></i><b>3.5</b> Poverty Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session-4---area-model-for-labor-market-statistics.html"><a href="session-4---area-model-for-labor-market-statistics.html"><i class="fa fa-check"></i><b>4</b> Session 4 - Area model for labor market statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="definition-of-the-multinomial-model.html"><a href="definition-of-the-multinomial-model.html"><i class="fa fa-check"></i><b>4.1</b> Definition of the Multinomial Model</a></li>
<li class="chapter" data-level="4.2" data-path="loading-libraries.html"><a href="loading-libraries.html"><i class="fa fa-check"></i><b>4.2</b> Loading Libraries</a></li>
<li class="chapter" data-level="4.3" data-path="reading-the-survey-and-direct-estimates.html"><a href="reading-the-survey-and-direct-estimates.html"><i class="fa fa-check"></i><b>4.3</b> Reading the survey and direct estimates</a></li>
<li class="chapter" data-level="4.4" data-path="domain-selection.html"><a href="domain-selection.html"><i class="fa fa-check"></i><b>4.4</b> Domain Selection</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-in-stan.html"><a href="modeling-in-stan.html"><i class="fa fa-check"></i><b>4.5</b> Modeling in <code>STAN</code></a></li>
<li class="chapter" data-level="4.6" data-path="preparing-supplies-for-stan.html"><a href="preparing-supplies-for-stan.html"><i class="fa fa-check"></i><b>4.6</b> Preparing supplies for <code>STAN</code></a></li>
<li class="chapter" data-level="4.7" data-path="model-validation.html"><a href="model-validation.html"><i class="fa fa-check"></i><b>4.7</b> Model validation</a>
<ul>
<li class="chapter" data-level="" data-path="model-validation.html"><a href="model-validation.html#fixed-effects"><i class="fa fa-check"></i>Fixed effects</a></li>
<li class="chapter" data-level="" data-path="model-validation.html"><a href="model-validation.html#random-effects"><i class="fa fa-check"></i>Random effects</a></li>
<li class="chapter" data-level="4.7.1" data-path="model-validation.html"><a href="model-validation.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>4.7.1</b> Posterior predictive distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="parameter-estimation..html"><a href="parameter-estimation..html"><i class="fa fa-check"></i><b>4.8</b> Parameter estimation.</a></li>
<li class="chapter" data-level="4.9" data-path="estimation-of-standard-deviation-and-coefficient-of-variation.html"><a href="estimation-of-standard-deviation-and-coefficient-of-variation.html"><i class="fa fa-check"></i><b>4.9</b> Estimation of Standard Deviation and Coefficient of Variation</a></li>
<li class="chapter" data-level="4.10" data-path="metodología-de-benchmarking.html"><a href="metodología-de-benchmarking.html"><i class="fa fa-check"></i><b>4.10</b> Metodología de Benchmarking</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="metodología-de-benchmarking.html"><a href="metodología-de-benchmarking.html#grafico-de-validación-del-benchmarking"><i class="fa fa-check"></i><b>4.10.1</b> Grafico de validación del Benchmarking</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="labor-market-maps..html"><a href="labor-market-maps..html"><i class="fa fa-check"></i><b>4.11</b> Labor market maps.</a>
<ul>
<li class="chapter" data-level="" data-path="labor-market-maps..html"><a href="labor-market-maps..html#occupancy-rate-1"><i class="fa fa-check"></i>Occupancy Rate</a></li>
<li class="chapter" data-level="" data-path="labor-market-maps..html"><a href="labor-market-maps..html#unemployment-rate-1"><i class="fa fa-check"></i>Unemployment Rate</a></li>
<li class="chapter" data-level="" data-path="labor-market-maps..html"><a href="labor-market-maps..html#inactivo"><i class="fa fa-check"></i>Inactivo</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a Area models for estimating poverty and labor market indicators </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reading-the-survey-and-direct-estimates" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Reading the survey and direct estimates<a href="reading-the-survey-and-direct-estimates.html#reading-the-survey-and-direct-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This code performs several operations on a labor survey in Jamaica, represented by the <code>encuesta</code> object, which is read from a file in RDS format. Here’s the breakdown:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Data Reading:</strong> The code reads data from the Jamaican labor survey from an RDS file located at ‘Resources/05_Employment/01_data_JAM.rds’. The data is stored in the <code>encuesta</code> object.</p></li>
<li><p><strong>Data Transformation:</strong> Through a sequence of operations using the <code>%&gt;%</code> pipe and the <code>transmute()</code> function from the <code>dplyr</code> package, the following transformations are performed on the survey:</p>
<ul>
<li>Specific columns <code>dam2</code>, <code>RFACT</code>, <code>PAR_COD</code>, <code>CONST_NUMBER</code>, <code>ED_NUMBER</code>, <code>STRATA</code>, and <code>EMPSTATUS</code> are selected from the survey.</li>
<li>More descriptive names are assigned to some columns such as <code>fep</code> for <code>RFACT</code>, <code>upm</code> by combining <code>PAR_COD</code>, <code>CONST_NUMBER</code>, and <code>ED_NUMBER</code>, <code>estrato</code> using conditions to define the value based on <code>STRATA</code>, and <code>empleo_label</code> and <code>empleo</code> representing specific categories derived from <code>EMPSTATUS</code> with labeled levels and categorical values.</li>
</ul></li>
</ol>
<p>In summary, the code reads a labor survey in Jamaica and performs a series of transformations on selected columns, renaming and reorganizing them for future analyses or processing.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="reading-the-survey-and-direct-estimates.html#cb64-1" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&#39;Recursos/05_Empleo/01_data_JAM.rds&#39;</span>)</span>
<span id="cb64-2"><a href="reading-the-survey-and-direct-estimates.html#cb64-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb64-3"><a href="reading-the-survey-and-direct-estimates.html#cb64-3" tabindex="-1"></a>id_dominio <span class="ot">&lt;-</span> <span class="st">&quot;dam2&quot;</span></span>
<span id="cb64-4"><a href="reading-the-survey-and-direct-estimates.html#cb64-4" tabindex="-1"></a></span>
<span id="cb64-5"><a href="reading-the-survey-and-direct-estimates.html#cb64-5" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span></span>
<span id="cb64-6"><a href="reading-the-survey-and-direct-estimates.html#cb64-6" tabindex="-1"></a>  encuesta <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="reading-the-survey-and-direct-estimates.html#cb64-7" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb64-8"><a href="reading-the-survey-and-direct-estimates.html#cb64-8" tabindex="-1"></a>    dam2,</span>
<span id="cb64-9"><a href="reading-the-survey-and-direct-estimates.html#cb64-9" tabindex="-1"></a>    <span class="at">fep =</span> RFACT,</span>
<span id="cb64-10"><a href="reading-the-survey-and-direct-estimates.html#cb64-10" tabindex="-1"></a>    <span class="at">upm =</span> <span class="fu">paste0</span>(PAR_COD , CONST_NUMBER, ED_NUMBER),</span>
<span id="cb64-11"><a href="reading-the-survey-and-direct-estimates.html#cb64-11" tabindex="-1"></a>    <span class="at">estrato =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(STRATA) ,strata,STRATA),</span>
<span id="cb64-12"><a href="reading-the-survey-and-direct-estimates.html#cb64-12" tabindex="-1"></a>    <span class="at">empleo_label =</span> <span class="fu">as_factor</span>(EMPSTATUS ,<span class="at">levels  =</span> <span class="st">&quot;labels&quot;</span>),</span>
<span id="cb64-13"><a href="reading-the-survey-and-direct-estimates.html#cb64-13" tabindex="-1"></a>    <span class="at">empleo =</span> <span class="fu">as_factor</span>(EMPSTATUS ,<span class="at">levels  =</span> <span class="st">&quot;values&quot;</span>) </span>
<span id="cb64-14"><a href="reading-the-survey-and-direct-estimates.html#cb64-14" tabindex="-1"></a>  )</span></code></pre></div>
<p>The presented code defines the sampling design for the analysis of the “survey” in R. The first line sets an option for handling singleton PSU (primary sampling units), indicating that adjustments need to be applied in standard error calculations. The second line uses the “as_survey_design” function from the “survey” library to define the sampling design. The function takes “encuesta” as an argument and the following parameters:</p>
<ul>
<li><p><code>strata</code>: The variable defining the strata in the survey, in this case, the “estrato” variable.</p></li>
<li><p><code>ids</code>: The variable identifying the PSUs in the survey, here, the “upm” variable.</p></li>
<li><p><code>weights</code>: The variable indicating the survey weights of each observation, in this case, the “fep” variable.</p></li>
<li><p><code>nest</code>: A logical parameter indicating whether the survey data is nested or not. In this case, it’s set to “TRUE” because the data is nested by domain.</p></li>
</ul>
<p>Together, these steps allow defining a sampling design that takes into account the sampling characteristics and the weights assigned to each observation in the survey. This is necessary to obtain precise and representative estimations of the parameters of interest.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="reading-the-survey-and-direct-estimates.html#cb65-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu=</span> <span class="st">&#39;adjust&#39;</span> )</span>
<span id="cb65-2"><a href="reading-the-survey-and-direct-estimates.html#cb65-2" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="reading-the-survey-and-direct-estimates.html#cb65-3" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb65-4"><a href="reading-the-survey-and-direct-estimates.html#cb65-4" tabindex="-1"></a>    <span class="at">strata =</span> estrato,</span>
<span id="cb65-5"><a href="reading-the-survey-and-direct-estimates.html#cb65-5" tabindex="-1"></a>    <span class="at">ids =</span> upm,</span>
<span id="cb65-6"><a href="reading-the-survey-and-direct-estimates.html#cb65-6" tabindex="-1"></a>    <span class="at">weights =</span> fep,</span>
<span id="cb65-7"><a href="reading-the-survey-and-direct-estimates.html#cb65-7" tabindex="-1"></a>    <span class="at">nest=</span>T</span>
<span id="cb65-8"><a href="reading-the-survey-and-direct-estimates.html#cb65-8" tabindex="-1"></a>  )</span></code></pre></div>
<p>The following code conducts a descriptive analysis based on a survey design represented by the object <code>diseno</code>.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Grouping and Filtering:</strong> It uses the <code>%&gt;%</code> function to chain operations. Initially, it groups the data by the domain identifier (<code>id_dominio</code>) using <code>group_by_at()</code> and subsequently filters observations where the variable <code>empleo</code> falls within the range of 3 to 5.</p></li>
<li><p><strong>Variable Summary:</strong> With the <code>summarise()</code> function, it computes various summaries for different categories of the variable <code>empleo</code>. These summaries include the weighted count for employed, unemployed, and inactive individuals (<code>n_ocupado</code>, <code>n_desocupado</code>, <code>n_inactivo</code>). Furthermore, it utilizes the <code>survey_mean()</code> function to obtain weighted mean estimates for each category of <code>empleo</code>, considering the variable type (<code>vartype</code>) and design effect (<code>deff</code>).</p></li>
</ol>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="reading-the-survey-and-direct-estimates.html#cb66-1" tabindex="-1"></a>indicador_dam <span class="ot">&lt;-</span></span>
<span id="cb66-2"><a href="reading-the-survey-and-direct-estimates.html#cb66-2" tabindex="-1"></a>  diseno <span class="sc">%&gt;%</span> <span class="fu">group_by_at</span>(id_dominio) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="reading-the-survey-and-direct-estimates.html#cb66-3" tabindex="-1"></a>  <span class="fu">filter</span>(empleo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="reading-the-survey-and-direct-estimates.html#cb66-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb66-5"><a href="reading-the-survey-and-direct-estimates.html#cb66-5" tabindex="-1"></a>    <span class="at">n_ocupado =</span> <span class="fu">unweighted</span>(<span class="fu">sum</span>(empleo <span class="sc">==</span> <span class="dv">3</span>)),</span>
<span id="cb66-6"><a href="reading-the-survey-and-direct-estimates.html#cb66-6" tabindex="-1"></a>    <span class="at">n_desocupado =</span> <span class="fu">unweighted</span>(<span class="fu">sum</span>(empleo <span class="sc">==</span> <span class="dv">4</span>)),</span>
<span id="cb66-7"><a href="reading-the-survey-and-direct-estimates.html#cb66-7" tabindex="-1"></a>    <span class="at">n_inactivo =</span> <span class="fu">unweighted</span>(<span class="fu">sum</span>(empleo <span class="sc">==</span> <span class="dv">5</span>)),</span>
<span id="cb66-8"><a href="reading-the-survey-and-direct-estimates.html#cb66-8" tabindex="-1"></a></span>
<span id="cb66-9"><a href="reading-the-survey-and-direct-estimates.html#cb66-9" tabindex="-1"></a>    <span class="at">Ocupado =</span> <span class="fu">survey_mean</span>(empleo <span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb66-10"><a href="reading-the-survey-and-direct-estimates.html#cb66-10" tabindex="-1"></a>      <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>,  <span class="st">&quot;var&quot;</span>),</span>
<span id="cb66-11"><a href="reading-the-survey-and-direct-estimates.html#cb66-11" tabindex="-1"></a>      <span class="at">deff =</span> T</span>
<span id="cb66-12"><a href="reading-the-survey-and-direct-estimates.html#cb66-12" tabindex="-1"></a>    ),</span>
<span id="cb66-13"><a href="reading-the-survey-and-direct-estimates.html#cb66-13" tabindex="-1"></a>    <span class="at">Desocupado =</span> <span class="fu">survey_mean</span>(empleo <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb66-14"><a href="reading-the-survey-and-direct-estimates.html#cb66-14" tabindex="-1"></a>                          <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>,  <span class="st">&quot;var&quot;</span>),</span>
<span id="cb66-15"><a href="reading-the-survey-and-direct-estimates.html#cb66-15" tabindex="-1"></a>                          <span class="at">deff =</span> T</span>
<span id="cb66-16"><a href="reading-the-survey-and-direct-estimates.html#cb66-16" tabindex="-1"></a>    ),</span>
<span id="cb66-17"><a href="reading-the-survey-and-direct-estimates.html#cb66-17" tabindex="-1"></a>    <span class="at">Inactivo =</span> <span class="fu">survey_mean</span>(empleo <span class="sc">==</span> <span class="dv">5</span>,</span>
<span id="cb66-18"><a href="reading-the-survey-and-direct-estimates.html#cb66-18" tabindex="-1"></a>                          <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>,  <span class="st">&quot;var&quot;</span>),</span>
<span id="cb66-19"><a href="reading-the-survey-and-direct-estimates.html#cb66-19" tabindex="-1"></a>                          <span class="at">deff =</span> T</span>
<span id="cb66-20"><a href="reading-the-survey-and-direct-estimates.html#cb66-20" tabindex="-1"></a>    )</span>
<span id="cb66-21"><a href="reading-the-survey-and-direct-estimates.html#cb66-21" tabindex="-1"></a>  )</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Upms counts by domains:</strong> This code performs operations on the survey data. First, it selects the columns id_dominio and upm, removes duplicate rows, and then counts the number of unique upm values for each id_dominio. Subsequently, it performs an inner join of these results with an existing object indicador_dam based on the id_dominio column, thus consolidating information about the quantity of unique upm values per identified domain in the survey.</li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="reading-the-survey-and-direct-estimates.html#cb67-1" tabindex="-1"></a>indicador_dam <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> <span class="fu">select</span>(id_dominio, upm) <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="reading-the-survey-and-direct-estimates.html#cb67-2" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="reading-the-survey-and-direct-estimates.html#cb67-3" tabindex="-1"></a>  <span class="fu">group_by_at</span>(id_dominio) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="reading-the-survey-and-direct-estimates.html#cb67-4" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&quot;n_upm&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="reading-the-survey-and-direct-estimates.html#cb67-5" tabindex="-1"></a>  <span class="fu">inner_join</span>(indicador_dam, <span class="at">by =</span> id_dominio)</span>
<span id="cb67-6"><a href="reading-the-survey-and-direct-estimates.html#cb67-6" tabindex="-1"></a><span class="co">#Save data----------------------------</span></span>
<span id="cb67-7"><a href="reading-the-survey-and-direct-estimates.html#cb67-7" tabindex="-1"></a><span class="fu">saveRDS</span>(indicador_dam,<span class="st">&#39;Recursos/05_Empleo/indicador_dam.Rds&#39;</span> )</span></code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="loading-libraries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="domain-selection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2021ASDA/05_S2_Work_Market.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Area models for estimating poverty and labor market indicators.pdf", "Area models for estimating poverty and labor market indicators.epub", "Area models for estimating poverty and labor market indicators.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
